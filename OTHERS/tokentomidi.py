import joblib
from GridTokenizer import remove_bars, detokenize

tokenizer = joblib.load("tokenizer_test2.pkl")

to_detok = [3141, 3056, 1933, 2130, 1736, 1973, 2169, 1741, 1982, 1696, 1937, 2134,
         3056, 1933, 2130, 1790, 1933, 2130, 1832, 2173, 3081, 2130, 2257, 1696,
         1937, 2134, 3045, 1692, 1933, 1741, 1977, 2080, 3060, 1973, 2076, 1739,
         1975, 2078, 1740, 1976, 2079, 1741, 1977, 2080, 1696, 1937, 2031, 3056,
         1879, 2026, 1696, 1885, 3056, 1879, 2026, 1736, 1919, 2076, 1599, 1977,
         1694, 1695, 1559, 1937, 1698, 2035, 3081, 2130, 1711, 2050, 1592, 1973,
         1739, 2078, 1982, 1559, 1937, 3045, 1933, 1694, 1695, 1559, 1937, 1698,
         2035, 3081, 2130, 1711, 2050, 1592, 1973, 1739, 2078, 1982, 1559, 1937,
         3045, 1933, 1792, 1793, 1606, 2031, 1796, 2136, 3049, 2026, 1806, 1640,
         1828, 1644, 2080, 1792, 1606, 1796, 3049, 2026, 1694, 1695, 1559, 1937,
         1698, 2035, 3045, 1933, 1711, 1592, 1739, 1596, 1977, 1694, 1559, 1698,
         3045, 1933, 1694, 1695, 1559, 1937, 1698, 2035, 3081, 2130, 1711, 2050,
         1592, 1973, 1739, 2078, 1982, 1559, 1937, 3045, 1933, 1694, 1695, 1559,
         1937, 1698, 2035, 3081, 2130, 1711, 2050, 1592, 1973, 1739, 2078, 1982,
         1559, 1937, 3045, 1933, 1792, 1793, 1606, 2031, 1796, 2136, 3049, 2026,
         1806, 1640, 1828, 1644, 2080, 1792, 1606, 1796, 3049, 2026, 1694, 1695,
         1559, 1937, 1698, 2035, 3045, 1933, 1711, 1592, 1739, 1596, 1977, 1792,
         1559, 1796, 3045, 1933, 1385, 1606, 1794, 1388, 1608, 1796, 1389, 1609,
         1797, 3049, 1790, 1933, 1414, 1640, 1826, 1347, 1473, 1696, 1349, 1475,
         1698, 1350, 1477, 1699, 3037, 1692, 1879, 1373, 1505, 1736, 1310, 1426,
         1696, 1312, 1428, 1698, 1313, 1429, 1699, 3033, 1692, 1835, 1505, 1826,
         1551, 1832, 1559, 1883, 3049, 1879, 2026, 1684, 1973, 2293, 2697, 2224,
         2638, 2184, 2609, 3099, 2570, 2120, 2561, 2078, 2534, 2024, 1936, 2442,
         1888, 2413, 3072, 2373, 1823, 2362, 1784, 2329, 1741, 1930, 2293, 3062,
         1879, 2130, 2298, 1830, 2023, 2369, 3076, 2178, 2407, 1982, 2293, 2471,
         2261, 2263, 2264, 3107, 2407, 2506, 2076, 2289, 2433, 1982, 2293, 2471,
         2261, 2263, 2264, 3107, 2407, 2506, 2076, 2289, 2433, 1982, 2471, 1885,
         2411, 3081, 2130, 2439, 1919, 2076, 2433, 1982, 2471, 1885, 2411, 3081,
         2130, 2439, 1919, 2076, 2433, 2176, 2471, 2134, 2302, 2411, 3099, 2335,
         2439, 2169, 2327, 2433, 2173, 2371, 2134, 2302, 2411, 3099, 2335, 2439,
         2289, 2433, 2532, 2293, 2471, 2601, 2259, 2260, 2134, 2443, 2264, 2512,
         3116, 2570, 2271, 2518, 2169, 2467, 2291, 2534, 2293, 2471, 2601, 2259,
         2260, 1937, 2134, 2035, 2264, 3099, 2439, 2050, 2271, 1973, 2169, 2078,
         2291, 1599, 1977, 1694, 1695, 1559, 1937, 1698, 2035, 3081, 2130, 1711,
         2050, 1592, 1973, 1739, 2078, 1741, 1982, 1694, 1695, 1385, 1559, 1475,
         1698, 3045, 1933, 1484, 1711, 1414, 1592, 1507, 1739, 1599, 1977, 3014,
         1198, 1381, 1126, 1227, 1416, 1229, 1420, 3029, 1555, 1599, 1977, 1741,
         1982, 1418, 1599, 1977, 3030, 1484, 1587, 1640, 1738, 1828, 1924, 1599,
         1977, 3082, 2050, 2166, 2213, 2290, 2367, 2436, 2176, 2471, 1418, 3032,
         1418, 2028, 1605, 1937, 2035, 1698, 1105, 3062, 1879, 2026, 2130, 2050,
         1826, 1592, 1594, 1229, 2254, 2220, 2411, 3099, 1198, 1711, 1467, 2076,
         2125, 1982, 1696, 1102, 3068, 1651, 1806, 1057, 2080, 1830, 1128, 1559,
         3080, 1919, 2078, 1642, 1739]

detok = tokenizer.detokenize(to_detok)
detok = remove_bars(detok)
print(detok[-60:])
detokenized = detokenize(detok, 'output.mid')
print(detokenized)